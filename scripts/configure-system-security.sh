#!/bin/bash
# Script combinÃ© pour configurer la sÃ©curitÃ© systÃ¨me
# Configure Fail2ban et Unattended Upgrades

set -e

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

echo "ğŸ”’ Configuration de la sÃ©curitÃ© systÃ¨me..."
echo "   Ce script configure:"
echo "   - Fail2ban (protection SSH)"
echo "   - Unattended Upgrades (mises Ã  jour automatiques)"
echo ""

# VÃ©rifier que le script est exÃ©cutÃ© en root
if [ "$EUID" -ne 0 ]; then 
    echo "âŒ Ce script doit Ãªtre exÃ©cutÃ© en root (utilisez sudo)"
    exit 1
fi

# Configuration Fail2ban
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "1ï¸âƒ£  Configuration de Fail2ban..."
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
"$SCRIPT_DIR/configure-fail2ban.sh"

echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "2ï¸âƒ£  Configuration de Unattended Upgrades..."
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
"$SCRIPT_DIR/configure-unattended-upgrades.sh"

echo ""
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "âœ… Configuration terminÃ©e!"
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""
echo "ğŸ“Š VÃ©rification:"
echo "   - Fail2ban: ./scripts/check-fail2ban.sh"
echo "   - Unattended Upgrades: ./scripts/check-unattended-upgrades.sh"
